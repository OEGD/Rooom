<html>

<head>
    <style>
        html,
        body {
            min-height: 100vh
        }

        body {
            display: flex;
            justify-content: center;
            align-items: center;
            overflow: hidden;
            flex-direction: column;
        }

        .book {
            position: relative;
            transform-style: preserve-3d;
        }

        .page {
            position: absolute;
            width: 50%;
            height: 100%;
            top: 0;
            left: 50%;
            transform-style: preserve-3d;
        }

        .side {
            position: absolute;
            top: 0;
            left: 0;
            backface-visibility: hidden;
            width: 100%;
            height: 100%;
            transform-style: preserve-3d;
        }

        .side0 {
            transform: none;
        }

        .side1 {
            transform: rotateY(180deg);
        }

        .flip {
            /*do nothing, its used by js*/
        }

        /* 
preserntaiton
*/
        body {
            background: slategray;
        }

        .book {
            width: 90vw;
            height: 80vh;
            perspective: 800px;
        }

        .page {
            transition: transform 1s;
            transform-origin: left center;
        }

        .side0 {
            background: linear-gradient(to right, rgba(0, 0, 0, 0.1), rgb(247, 245, 235) 0.5em);
            padding: 1em;
            box-sizing: border-box;
        }

        .side1 {
            background: linear-gradient(to left, rgba(0, 0, 0, 0.1), rgb(247, 245, 235) 0.8em);
            padding: 1em;
            box-sizing: border-box;
        }

        .page:first-of-type .side0 {
            box-shadow: -10px 0 10px -6px rgba(0, 0, 0, 0.3);
        }

        .page:last-of-type .side1 {
            box-shadow: 10px 0 10px -6px rgba(0, 0, 0, 0.3);
        }


        #p1s0 {
            background-color: white;
            /* background-image: url('https://allplayces.de/wp-content/uploads/2022/10/Jingle-Bells_mitNotenbuchstaben_v02.jpg'); */
            background-position: center;
            background-repeat: no-repeat;
            background-size: contain;
        }

        #p2s0 {
            background-color: white;
            /* background-image: url('https://allplayces.de/wp-content/uploads/2022/10/Jingle-Bells_mitL.jpg'); */
            background-position: center;
            background-repeat: no-repeat;
            background-size: contain;
        }

        #cover {
            display: flex;
            justify-content: center;
            align-items: center;
            color: white;
            background: rgb(44, 44, 44);
            font-size: 3vw;
            text-align: center;
        }

        .side:hover {
            cursor: pointer;
        }

        .page-content {
            display: flex;
            justify-content: center;
            align-items: center;
            font-size: 18px;
            text-align: center;
            flex-direction: column;
        }

        .wordHeading {
            font-size: 2vw;
        }

        .wordWrapping {
            font-size: 1.5vw;
        }

        .bookmarks {
            display: flex;
            justify-content: center;
            align-items: center;
            margin: 2vw;
        }
    </style>
</head>

<body>
    <div class="book">
        <div class="page page0">
            <div id="cover" class="side side0">Metaverse<br>
                Escape Rooom<br>
                Hilfesystem
                <br>
                <br>
                ACHTUNG<br>
                Öffne dieses Buch nur, wenn
                du Hilfe beim Lösen der
                Rätsel benötigtst
            </div>
            <div id="p0s1" class="side side1"></div>
        </div>
        <div class="page page1">
            <div id="p1s0" class="side side0 page-content">
                <p><span class="wordHeading"><strong>Vorwort </strong></span></p>
                <p><span class="wordWrapping">Um den Metaverse Escape Rooom zu l&ouml;sen und dadurch Weihnachten zu
                        retten, hat dich Santa Claus um die Unterst&uuml;tzung bei 4 Aufgaben gebeten. Erst nach
                        Absolvierung all dieser Tasks l&auml;sst sich die verschlossene T&uuml;r &ouml;ffnen - das
                        f&uuml;nfte und finale R&auml;tsel. Auf den folgenden Doppelseitenseiten findtest du jeweils 3
                        Hinweise zu den jeweiligen R&auml;tseln / Aufgaben. Der erste Hinweis ist noch sehr allgemein
                        gehalten, der letzte verr&auml;t dir die L&ouml;sung. </span></p>
                <p>&nbsp;</p>
                <p><span class="wordWrapping">&Uuml;bersicht:</span></p>
                <p><span class="wordWrapping">Santas 1. Aufgabe - das Weihnachtslied - Seite 1 </span></p>
                <p><span class="wordWrapping">Santas 2. Aufgabe - die Geschenke - Seite 3</span></p>
                <p><span class="wordWrapping">Santas 3. Aufgabe - die Essens-Bestellung - Seite 5 </span></p>
                <p><span class="wordWrapping">Santas 4. Aufgabe - Mrs. Claus - Seite 7 Das letzte R&auml;tsel - die
                        verschlossene T&uuml;r - Seite 9</span></p>

            </div>
            <div class="side side1">page 1 side 1</div>
            <!--Rätsel 1 Seite 1-->
        </div>
        <div class="page page2">
            <div id="p2s0" class="side side0">page 2 side 0</div>
            <!--Rätsel 1 Seite 2-->
            <div id="p2s1" class="side side1">page 2 side 1</div>
        </div>
        <div class="page page3">
            <div class="side side0">page 3 side 0</div>
            <!--Rätsel 2 -->
            <div class="side side1">page 3 side 1</div>
        </div>
        <div class="page page4">
            <div class="side side0">page 4 side 0</div>
            <!--Rätsel 3 -->
            <div class="side side1">page 4 side 1</div>
        </div>
        <div class="page page5">
            <div class="side side0">page 5 side 0</div>
            <!--Rätsel 4 -->
            <div class="side side1">page 5 side 1</div>
        </div>
    </div>
    <div class="bookmarks">
        <button id="sol1" onclick="bookmark(this.id)">Rätsel 1</button>
        <button id="sol2" onclick="bookmark(this.id)">Rätsel 2</button>
        <button id="sol3" onclick="bookmark(this.id)">Rätsel 3</button>
        <button id="sol4" onclick="bookmark(this.id)">Rätsel 4</button>
        <button id="sol5" onclick="bookmark(this.id)">Rätsel 5</button>
    </div>
    <script>
        const pages = Array.from(document.querySelectorAll(".book .page"));
        const book = document.querySelector(".book");
        let leftStack = [];
        let rightStack = Array.from(pages).reverse(); // [p3,p2,p1,p0]

        updatePagesDepth(rightStack);
        console.log(leftStack);
        console.log(rightStack);
        for (const page of pages) {
            page.addEventListener("click", function (e) {
                if (e.currentTarget.classList.contains("flip")) { //clicked on left stack page
                    const page = leftStack.pop();
                    rightStack.push(page);
                    page.classList.remove("flip");
                    updatePagesDepth(rightStack);
                    console.log(leftStack);
                }
                else { // clicked on right stack page
                    const page = rightStack.pop();
                    leftStack.push(page);
                    page.classList.add("flip");
                    updatePagesDepth(leftStack);
                }
            });
        }

        function updatePagesDepth(stack) { // first el = farthest
            for (const [i, page] of stack.entries()) {
                if (stack == leftStack) {
                    page.style.transform = `rotateY(-180deg) translateZ(${-i}px)`;
                }
                else {
                    page.style.transform = `rotateY(0) translateZ(${i}px)`;
                }
            }
        }

        function bookmark(id) {
            switch (id) {
                case 'sol1':
                    if (rightStack.length >= 4) {
                        for (i = rightStack.length; i >= 5; i--) {
                            setTimeout(function () {
                            }, 200);
                            const page = rightStack.pop();
                            leftStack.push(page);
                            page.classList.add("flip");
                            updatePagesDepth(leftStack);
                        }
                    } 
                    break;
                case 'sol2':
                    break;
                case 'sol3':
                    break;
                case 'sol4':
                    break;
                case 'sol5':
                    break;
            }
        }
    </script>
</body>

</html>